# run e2e analyses

gw150914_analysis:
  stage: install
  tags:
    - openstack
  when: manual

  image: containers.ligo.org/lscsoft/bilby/v2-bilby-python38
  script:
    - source activate python38
    - mkdir -p .pip38
    - pip --cache-dir=.pip38 install .
    - cd examples/GW150914_IMRPhenomPv2
    - parallel_bilby_generation GW150914.ini
    - mpirun -n 16 parallel_bilby_analysis outdir/data/GW150914_data_dump.pickle --label GW150914_0 --outdir outdir/result --sampling-seed 0


fast_injection:
  stage: install
  tags:
    - openstack
  when: manual

  image: containers.ligo.org/lscsoft/bilby/v2-bilby-python38
  script:
    - source activate python38
    - mkdir -p .pip38
    - pip --cache-dir=.pip38 install .
    - cd examples/fast_injection
    - parallel_bilby_generation fast_injection.ini
    - mpirun -n 16 parallel_bilby_analysis outdir/data/fast_injection_data_dump.pickle --label fast_injection --outdir outdir/result --sampling-seed 0
