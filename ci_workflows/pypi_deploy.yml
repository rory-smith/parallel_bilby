# on a new tagged commit, deploy to Pypi

deploy_release:
  stage: deploy
  tags:
    - cit
  image: containers.ligo.org/lscsoft/bilby/v2-bilby-python38
  variables:
    TWINE_USERNAME: $PYPI_USERNAME
    TWINE_PASSWORD: $PYPI_PASSWORD
  before_script:
    - pip install twine
    - python setup.py sdist
  script:
    - twine upload dist/*
  only:
  - tags
